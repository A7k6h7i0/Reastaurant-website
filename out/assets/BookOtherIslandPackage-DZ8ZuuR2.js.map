{"version":3,"file":"BookOtherIslandPackage-DZ8ZuuR2.js","sources":["../../src/pages/book/BookOtherIslandPackage.tsx"],"sourcesContent":["import { useParams } from \"react-router-dom\";\r\nimport { useEffect, useMemo, useState } from \"react\";\r\nimport { otherIslandPackages } from \"../../data/otherIslandPackages\";\r\n\r\n/**\r\n * âœ… Production-safe API URL\r\n */\r\nconst API_URL = import.meta.env.VITE_API_URL;\r\n\r\nif (!API_URL) {\r\n  console.error(\"âŒ VITE_API_URL is missing.\");\r\n}\r\n\r\nconst BookOtherIslandPackage = () => {\r\n  const { id } = useParams<{ id: string }>();\r\n\r\n  const selectedPackage = useMemo(\r\n    () => otherIslandPackages.find((p) => p.id === id),\r\n    [id]\r\n  );\r\n\r\n  const [name, setName] = useState(\"\");\r\n  const [email, setEmail] = useState(\"\");\r\n  const [phone, setPhone] = useState(\"\");\r\n  const [token, setToken] = useState(\"\");\r\n  const [submitted, setSubmitted] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setToken(`DD-${Date.now().toString(36).toUpperCase()}`);\r\n  }, []);\r\n\r\n  /* ðŸ›‘ SAFETY GUARD */\r\n  if (!selectedPackage) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <p className=\"text-lg font-semibold text-red-600\">Package not found</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const handleBooking = async () => {\r\n    if (!name || !email || !phone) {\r\n      alert(\"Please fill all details\");\r\n      return;\r\n    }\r\n\r\n    if (!API_URL) {\r\n      alert(\"Booking service unavailable\");\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n\r\n    try {\r\n      const res = await fetch(`${API_URL}/api/book-tour`, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          name,\r\n          email,\r\n          phone,\r\n          token,\r\n          packageId: selectedPackage.code,\r\n        }),\r\n      });\r\n\r\n      if (!res.ok) {\r\n        const text = await res.text();\r\n        throw new Error(text || \"Booking failed\");\r\n      }\r\n\r\n      setSubmitted(true);\r\n    } catch (err) {\r\n      console.error(err);\r\n      alert(\"Booking failed. Please try again.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <section className=\"max-w-6xl mx-auto px-6 py-12 space-y-10\">\r\n      {/* PACKAGE DETAILS */}\r\n      <div className=\"bg-white rounded-3xl shadow p-8 space-y-6\">\r\n        <h1 className=\"text-3xl font-bold\">{selectedPackage.title}</h1>\r\n        <p className=\"text-gray-600\">{selectedPackage.days}</p>\r\n\r\n        <div>\r\n          <h3 className=\"font-semibold\">Hotels Used</h3>\r\n          <ul className=\"list-disc pl-6\">\r\n            <li>\r\n              <b>Baratang:</b> {selectedPackage.hotels.baratang.join(\", \")}\r\n            </li>\r\n\r\n            {selectedPackage.hotels.havelock.length > 0 && (\r\n              <li>\r\n                <b>Havelock:</b> {selectedPackage.hotels.havelock.join(\", \")}{\" \"}\r\n                \r\n              </li>\r\n            )}\r\n\r\n            <li>\r\n              <b>Port Blair:</b> {selectedPackage.hotels.portBlair.join(\", \")} \r\n            </li>\r\n          </ul>\r\n        </div>\r\n\r\n        <div>\r\n          <h3 className=\"font-semibold\">Tour Itinerary</h3>\r\n          {selectedPackage.itinerary.map((day) => (\r\n            <p key={day.day}>\r\n              <strong>{day.day}:</strong> {day.description}\r\n            </p>\r\n          ))}\r\n        </div>\r\n\r\n        <div>\r\n          <h3 className=\"font-semibold\">Package Includes</h3>\r\n          <ul className=\"list-disc pl-6\">\r\n            {selectedPackage.includes.map((x) => (\r\n              <li key={x}>{x}</li>\r\n            ))}\r\n          </ul>\r\n        </div>\r\n\r\n        <div>\r\n          <h3 className=\"font-semibold\">Package Excludes</h3>\r\n          <ul className=\"list-disc pl-6\">\r\n            {selectedPackage.excludes.map((x) => (\r\n              <li key={x}>{x}</li>\r\n            ))}\r\n          </ul>\r\n        </div>\r\n\r\n        <div>\r\n          <h3 className=\"font-semibold\">Important Notes</h3>\r\n          <ul className=\"list-disc pl-6\">\r\n            {selectedPackage.notes.map((x) => (\r\n              <li key={x}>{x}</li>\r\n            ))}\r\n          </ul>\r\n        </div>\r\n      </div>\r\n\r\n      {/* BOOKING FORM */}\r\n      <div className=\"bg-white rounded-3xl shadow p-8 space-y-4\">\r\n        <h2 className=\"text-2xl font-bold\">Send Booking Request</h2>\r\n\r\n        {submitted ? (\r\n          <p className=\"text-green-600 font-semibold\">\r\n            âœ… Booking successful. Token: <strong>{token}</strong>\r\n          </p>\r\n        ) : (\r\n          <>\r\n            <input\r\n              className=\"w-full border p-3 rounded\"\r\n              placeholder=\"Full Name\"\r\n              onChange={(e) => setName(e.target.value)}\r\n            />\r\n            <input\r\n              className=\"w-full border p-3 rounded\"\r\n              placeholder=\"Mobile Number\"\r\n              onChange={(e) => setPhone(e.target.value)}\r\n            />\r\n            <input\r\n              className=\"w-full border p-3 rounded\"\r\n              placeholder=\"Email Address\"\r\n              onChange={(e) => setEmail(e.target.value)}\r\n            />\r\n            <input\r\n              className=\"w-full border p-3 rounded bg-gray-100\"\r\n              value={token}\r\n              readOnly\r\n            />\r\n\r\n            <button\r\n              onClick={handleBooking}\r\n              disabled={loading}\r\n              className=\"bg-forest text-white px-6 py-3 rounded-xl disabled:opacity-60\"\r\n            >\r\n              {loading ? \"Sending...\" : \"Send Booking Request\"}\r\n            </button>\r\n          </>\r\n        )}\r\n      </div>\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default BookOtherIslandPackage;"],"names":["API_URL","BookOtherIslandPackage","id","useParams","selectedPackage","useMemo","otherIslandPackages","p","name","setName","useState","email","setEmail","phone","setPhone","token","setToken","submitted","setSubmitted","loading","setLoading","useEffect","jsx","handleBooking","res","text","err","jsxs","day","x","Fragment","e"],"mappings":"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"}