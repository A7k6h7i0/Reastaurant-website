{"version":3,"file":"BookPackage-Ce42Jk_8.js","sources":["../../src/pages/book/BookPackage.tsx"],"sourcesContent":["import { useParams } from \"react-router-dom\";\r\nimport { useEffect, useMemo, useState } from \"react\";\r\nimport { packages } from \"../../data/packages\";\r\n\r\n/**\r\n * ‚úÖ Production-safe API URL\r\n * Must be defined in Vercel env as:\r\n * VITE_API_URL=https://<render-backend>.onrender.com\r\n */\r\nconst API_URL = import.meta.env.VITE_API_URL;\r\n\r\nif (!API_URL) {\r\n  console.error(\"‚ùå VITE_API_URL is missing. Booking will fail in production.\");\r\n}\r\n\r\nconst BookPackage = () => {\r\n  const { id } = useParams<{ id: string }>();\r\n\r\n  const selectedPackage = useMemo(\r\n    () => packages.find((p) => p.id === id),\r\n    [id]\r\n  );\r\n\r\n  const [name, setName] = useState(\"\");\r\n  const [email, setEmail] = useState(\"\");\r\n  const [phone, setPhone] = useState(\"\");\r\n  const [token, setToken] = useState(\"\");\r\n  const [submitted, setSubmitted] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setToken(`DDR-${Date.now().toString(36).toUpperCase()}`);\r\n  }, []);\r\n\r\n  /* üõë Guard */\r\n  if (!selectedPackage) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <p className=\"text-lg font-semibold\">Loading package details‚Ä¶</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  /* ===============================\r\n     üì¶ PRODUCTION-READY BOOKING\r\n     =============================== */\r\n  const handleBooking = async () => {\r\n    if (!name || !email || !phone) {\r\n      alert(\"Please fill all details\");\r\n      return;\r\n    }\r\n\r\n    if (!API_URL) {\r\n      alert(\"Booking service unavailable. Please try again later.\");\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n\r\n    try {\r\n      const res = await fetch(`${API_URL}/api/book-tour`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({\r\n          name,\r\n          email,\r\n          phone,\r\n          token,\r\n          packageId: selectedPackage.id,\r\n        }),\r\n      });\r\n\r\n      if (!res.ok) {\r\n        const errorText = await res.text();\r\n        throw new Error(errorText || \"Booking API failed\");\r\n      }\r\n\r\n      setSubmitted(true);\r\n    } catch (err) {\r\n      console.error(\"‚ùå Booking failed:\", err);\r\n      alert(\"Booking failed. Please try again.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <section className=\"max-w-5xl mx-auto px-6 py-12 space-y-10\">\r\n\r\n      {/* ================= PACKAGE DETAILS ================= */}\r\n      <div className=\"bg-white rounded-3xl shadow p-8 space-y-6\">\r\n        <h1 className=\"text-3xl font-bold\">{selectedPackage.title}</h1>\r\n        <p className=\"text-gray-600\">{selectedPackage.nights}</p>\r\n\r\n        {/* <div>\r\n          <h3 className=\"font-semibold text-lg mb-2\">Room Tariff</h3>\r\n          <ul className=\"list-disc pl-6 space-y-1\">\r\n            {selectedPackage.roomTariff.map((item) => (\r\n              <li key={item}>{item}</li>\r\n            ))}\r\n          </ul>\r\n        </div>\r\n\r\n        <div>\r\n          <h3 className=\"font-semibold text-lg mb-2\">Other Components</h3>\r\n          <ul className=\"list-disc pl-6 space-y-1\">\r\n            {selectedPackage.backendComponents.map((item) => (\r\n              <li key={item}>{item}</li>\r\n            ))}\r\n          </ul>\r\n        </div> */}\r\n        <div>\r\n          <h3 className=\"font-semibold text-lg mb-2\">Tour Itinerary</h3>\r\n          <div className=\"space-y-3\">\r\n            {selectedPackage.itinerary.map((day) => (\r\n              <p key={day.day}>\r\n                <strong>{day.day}:</strong> {day.description}\r\n              </p>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        <div>\r\n          <h3 className=\"font-semibold text-lg mb-2\">Package Includes</h3>\r\n          <ul className=\"list-disc pl-6 space-y-1\">\r\n            {selectedPackage.includes.map((item) => (\r\n              <li key={item}>{item}</li>\r\n            ))}\r\n          </ul>\r\n        </div>\r\n\r\n        <div>\r\n          <h3 className=\"font-semibold text-lg mb-2\">Package Excludes</h3>\r\n          <ul className=\"list-disc pl-6 space-y-1\">\r\n            {selectedPackage.excludes.map((item) => (\r\n              <li key={item}>{item}</li>\r\n            ))}\r\n          </ul>\r\n        </div>\r\n\r\n        <div>\r\n          <h3 className=\"font-semibold text-lg mb-2\">Important Notes</h3>\r\n          <ul className=\"list-disc pl-6 space-y-1\">\r\n            {selectedPackage.notes.map((item) => (\r\n              <li key={item}>{item}</li>\r\n            ))}\r\n          </ul>\r\n        </div>\r\n\r\n        \r\n      </div>\r\n\r\n      {/* ================= BOOKING FORM ================= */}\r\n      <div className=\"bg-white rounded-3xl shadow p-8 space-y-4\">\r\n        <h2 className=\"text-2xl font-bold\">Send Booking Request</h2>\r\n\r\n        {submitted ? (\r\n          <p className=\"text-green-600 font-semibold\">\r\n            ‚úÖ Booking successful. Your token: <strong>{token}</strong>\r\n          </p>\r\n        ) : (\r\n          <>\r\n            <input\r\n              placeholder=\"Full Name\"\r\n              value={name}\r\n              onChange={(e) => setName(e.target.value)}\r\n              className=\"w-full border p-3 rounded\"\r\n            />\r\n            <input\r\n              placeholder=\"Mobile Number\"\r\n              value={phone}\r\n              onChange={(e) => setPhone(e.target.value)}\r\n              className=\"w-full border p-3 rounded\"\r\n            />\r\n            <input\r\n              placeholder=\"Email Address\"\r\n              value={email}\r\n              onChange={(e) => setEmail(e.target.value)}\r\n              className=\"w-full border p-3 rounded\"\r\n            />\r\n            <input\r\n              value={token}\r\n              readOnly\r\n              className=\"w-full border p-3 rounded bg-gray-100\"\r\n            />\r\n\r\n            <button\r\n              onClick={handleBooking}\r\n              disabled={loading}\r\n              className=\"bg-forest text-white px-6 py-3 rounded-xl disabled:opacity-60\"\r\n            >\r\n              {loading ? \"Sending...\" : \"Send Booking Request\"}\r\n            </button>\r\n          </>\r\n        )}\r\n      </div>\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default BookPackage;\r\n"],"names":["API_URL","BookPackage","id","useParams","selectedPackage","useMemo","packages","p","name","setName","useState","email","setEmail","phone","setPhone","token","setToken","submitted","setSubmitted","loading","setLoading","useEffect","jsx","handleBooking","res","errorText","err","jsxs","day","item","Fragment","e"],"mappings":"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"}